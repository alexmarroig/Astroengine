Build a Python backend API for a premium astrology app. Use FastAPI + Swiss Ephemeris (pyswisseph) for accurate calculations. I need this to run on Replit Free using the Run button.



Create the following file structure:



- main.py
- requirements.txt
- .replit
- astro/__init__.py
- astro/utils.py
- astro/ephemeris.py
- astro/aspects.py
- ai/prompts.py



1) requirements.txt must include:
fastapi==0.115.0
uvicorn[standard]==0.30.6
pydantic==2.9.2
pyswisseph==2.10.3.2
python-dotenv==1.0.1
httpx==0.27.2



2) .replit must run the server with uvicorn on port 8000. Use:
run = "python -m uvicorn main:app --host 0.0.0.0 --port 8000"



3) main.py:
- Create FastAPI app with routes:
  GET /health -> {"ok": true}
  POST /v1/chart/natal -> compute natal chart using Swiss Ephemeris, houses + planets
  POST /v1/chart/transits -> compute transits for target_date at 12:00 local time, plus aspects transit-to-natal
  POST /v1/ai/cosmic-chat -> call OpenAI chat completions using OPENAI_API_KEY from environment; take {user_question, astro_payload, tone, language}



- Add /docs working (FastAPI default)



4) astro/utils.py must provide:
- to_julian_day(dt)
- deg_to_sign(lon) returning sign name + degrees in sign
- angle_diff(a,b) returning minimal separation 0..180



5) astro/ephemeris.py:
- Use swe.calc_ut to compute planet longitudes (Sun..Pluto)
- Compute houses via swe.houses using lat/lng and house_system (default 'P')
- Convert local datetime to UTC using tz_offset_minutes
- Return JSON:
  - utc_datetime
  - jd_ut
  - houses: system, cusps, asc, mc
  - planets: lon, sign, deg_in_sign



6) astro/aspects.py:
- Compute aspects between transit planets and natal planets for major aspects:
  Conjunction 0, Opposition 180, Square 90, Trine 120, Sextile 60
- Use default orbs: 6,6,5,5,4 degrees respectively
- Return a list sorted by tightest orb
- Include influence classification:
  Trine/Sextile => "Fluid influence"
  Square/Opposition => "Challenging influence"
  Conjunction => "Intense influence"



7) ai/prompts.py:
- Build messages for the AI:
  - Must be calm, non-deterministic, no concrete predictions
  - No fear-based language
  - No medical/legal claims
  - Avoid astrological glyphs in the main output
  - Present 2-3 plausible manifestations when symbolism is ambiguous
  - Output concise sections and bullets



After creating files, ensure pressing Run starts the API and exposes /health and /docs.



IMPORTANT: If any missing import or runtime error occurs, fix it automatically and keep the API running.
